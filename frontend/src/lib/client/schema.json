{"info":{"title":"Purplix.io","version":"0.0.1","termsOfService":"http://localhost/terms-of-service","license":{"name":"GNU Affero General Public License v3.0","identifier":"AGPL-3.0","url":"https://github.com/WardPearce/Purplix.io/blob/main/LICENSE"}},"openapi":"3.1.0","servers":[{"url":"http://localhost/api","description":"Production API"}],"paths":{"/controllers/account/{email}/login":{"post":{"tags":["account"],"summary":"Login","description":"Validate signature and OTP code","operationId":"ControllersAccountEmailLoginLogin","parameters":[{"name":"captcha","in":"query","schema":{"type":"string"},"required":true,"deprecated":false,"allowEmptyValue":false,"allowReserved":false},{"name":"otp","in":"query","schema":{"oneOf":[{"type":"null"},{"type":"string"}]},"required":false,"deprecated":false,"allowEmptyValue":false,"allowReserved":false},{"name":"email","in":"path","schema":{"type":"string"},"required":true,"deprecated":false,"allowEmptyValue":false,"allowReserved":false}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserLoginSignatureModel"}}},"required":true},"responses":{"201":{"description":"Document created, URL follows","headers":{},"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserJtiModel"}}}},"401":{"description":"No permission -- see authorization schemes","content":{"application/json":{"schema":{"oneOf":[{"properties":{"status_code":{"type":"integer"},"detail":{"type":"string"},"extra":{"additionalProperties":{},"type":["null","object","array"]}},"type":"object","required":["detail","status_code"],"description":"Invalid Captcha","examples":[{"status_code":401,"detail":"Unauthorized","extra":{}}]},{"properties":{"status_code":{"type":"integer"},"detail":{"type":"string"},"extra":{"additionalProperties":{},"type":["null","object","array"]}},"type":"object","required":["detail","status_code"],"description":"Invalid Account Auth","examples":[{"status_code":401,"detail":"Unauthorized","extra":{}}]}]}}}},"400":{"description":"Bad request syntax or unsupported method","content":{"application/json":{"schema":{"properties":{"status_code":{"type":"integer"},"detail":{"type":"string"},"extra":{"additionalProperties":{},"type":["null","object","array"]}},"type":"object","required":["detail","status_code"],"description":"Validation Exception","examples":[{"status_code":400,"detail":"Bad Request","extra":{}}]}}}}},"deprecated":false}},"/controllers/account/{email}/public":{"get":{"tags":["account"],"summary":"Public","description":"Public KDF details","operationId":"ControllersAccountEmailPublicPublic","parameters":[{"name":"email","in":"path","schema":{"type":"string"},"required":true,"deprecated":false,"allowEmptyValue":false,"allowReserved":false}],"responses":{"200":{"description":"Request fulfilled, document follows","headers":{},"content":{"application/json":{"schema":{"$ref":"#/components/schemas/PublicUserModel"}}}},"400":{"description":"Bad request syntax or unsupported method","content":{"application/json":{"schema":{"properties":{"status_code":{"type":"integer"},"detail":{"type":"string"},"extra":{"additionalProperties":{},"type":["null","object","array"]}},"type":"object","required":["detail","status_code"],"description":"Validation Exception","examples":[{"status_code":400,"detail":"Bad Request","extra":{}}]}}}}},"deprecated":false}},"/controllers/account/{email}/to-sign":{"get":{"tags":["account"],"summary":"ToSign","description":"Used to generate a unique code to sign.","operationId":"ControllersAccountEmailToSignToSign","parameters":[{"name":"email","in":"path","schema":{"type":"string"},"required":true,"deprecated":false,"allowEmptyValue":false,"allowReserved":false}],"responses":{"200":{"description":"Request fulfilled, document follows","headers":{},"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserToSignModel"}}}},"404":{"description":"Nothing matches the given URI","content":{"application/json":{"schema":{"properties":{"status_code":{"type":"integer"},"detail":{"type":"string"},"extra":{"additionalProperties":{},"type":["null","object","array"]}},"type":"object","required":["detail","status_code"],"description":"User Not Found Exception","examples":[{"status_code":404,"detail":"Not Found","extra":{}}]}}}},"400":{"description":"Bad request syntax or unsupported method","content":{"application/json":{"schema":{"properties":{"status_code":{"type":"integer"},"detail":{"type":"string"},"extra":{"additionalProperties":{},"type":["null","object","array"]}},"type":"object","required":["detail","status_code"],"description":"Validation Exception","examples":[{"status_code":400,"detail":"Bad Request","extra":{}}]}}}}},"deprecated":false}},"/controllers/account/{email}/email/verify/{email_secret}":{"get":{"tags":["account"],"summary":"VerifyEmail","description":"Verify email for given account","operationId":"ControllersAccountEmailVerifyEmailSecretVerifyEmail","parameters":[{"name":"email","in":"path","schema":{"type":"string"},"required":true,"deprecated":false,"allowEmptyValue":false,"allowReserved":false},{"name":"email_secret","in":"path","schema":{"type":"string"},"required":true,"deprecated":false,"allowEmptyValue":false,"allowReserved":false}],"responses":{"200":{"description":"Request fulfilled, document follows","headers":{},"content":{"application/json":{"schema":{}}}},"400":{"description":"Bad request syntax or unsupported method","content":{"application/json":{"schema":{"properties":{"status_code":{"type":"integer"},"detail":{"type":"string"},"extra":{"additionalProperties":{},"type":["null","object","array"]}},"type":"object","required":["detail","status_code"],"description":"Validation Exception","examples":[{"status_code":400,"detail":"Bad Request","extra":{}}]}}}}},"deprecated":false}},"/controllers/account/otp/setup":{"post":{"tags":["account"],"summary":"OtpSetup","description":"Used to confirm OTP is completed","operationId":"ControllersAccountOtpSetupOtpSetup","parameters":[{"name":"otp","in":"query","schema":{"type":"string"},"required":true,"deprecated":false,"allowEmptyValue":false,"allowReserved":false}],"responses":{"201":{"description":"Document created, URL follows","headers":{},"content":{"application/json":{"schema":{}}}},"400":{"description":"Bad request syntax or unsupported method","content":{"application/json":{"schema":{"oneOf":[{"properties":{"status_code":{"type":"integer"},"detail":{"type":"string"},"extra":{"additionalProperties":{},"type":["null","object","array"]}},"type":"object","required":["detail","status_code"],"description":"Otp Already Completed","examples":[{"status_code":400,"detail":"Bad Request","extra":{}}]},{"properties":{"status_code":{"type":"integer"},"detail":{"type":"string"},"extra":{"additionalProperties":{},"type":["null","object","array"]}},"type":"object","required":["detail","status_code"],"description":"Validation Exception","examples":[{"status_code":400,"detail":"Bad Request","extra":{}}]}]}}}}},"deprecated":false}},"/controllers/account/otp/reset":{"delete":{"tags":["account"],"summary":"ResetOtp","description":"Reset OTP","operationId":"ControllersAccountOtpResetResetOtp","parameters":[{"name":"otp","in":"query","schema":{"type":"string"},"required":true,"deprecated":false,"allowEmptyValue":false,"allowReserved":false}],"responses":{"200":{"description":"Request fulfilled, document follows","headers":{},"content":{"application/json":{"schema":{"$ref":"#/components/schemas/OtpModel"}}}},"400":{"description":"Bad request syntax or unsupported method","content":{"application/json":{"schema":{"properties":{"status_code":{"type":"integer"},"detail":{"type":"string"},"extra":{"additionalProperties":{},"type":["null","object","array"]}},"type":"object","required":["detail","status_code"],"description":"Validation Exception","examples":[{"status_code":400,"detail":"Bad Request","extra":{}}]}}}}},"deprecated":false}},"/controllers/account/notifications/webhook/add":{"post":{"tags":["account","notifications","webhook"],"summary":"AddWebhook","description":"Add a webhook","operationId":"ControllersAccountNotificationsWebhookAddAddWebhook","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/WebhookModel"}}},"required":true},"responses":{"201":{"description":"Document created, URL follows","headers":{}},"400":{"description":"Bad request syntax or unsupported method","content":{"application/json":{"schema":{"properties":{"status_code":{"type":"integer"},"detail":{"type":"string"},"extra":{"additionalProperties":{},"type":["null","object","array"]}},"type":"object","required":["detail","status_code"],"description":"Validation Exception","examples":[{"status_code":400,"detail":"Bad Request","extra":{}}]}}}}},"deprecated":false}},"/controllers/account/notifications/webhook/remove":{"delete":{"tags":["account","notifications","webhook"],"summary":"RemoveWebhook","description":"Remove a webhook","operationId":"ControllersAccountNotificationsWebhookRemoveRemoveWebhook","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/WebhookModel"}}},"required":true},"responses":{"204":{"description":"Request fulfilled, nothing follows","headers":{}},"400":{"description":"Bad request syntax or unsupported method","content":{"application/json":{"schema":{"properties":{"status_code":{"type":"integer"},"detail":{"type":"string"},"extra":{"additionalProperties":{},"type":["null","object","array"]}},"type":"object","required":["detail","status_code"],"description":"Validation Exception","examples":[{"status_code":400,"detail":"Bad Request","extra":{}}]}}}}},"deprecated":false}},"/controllers/account/notifications/email/add":{"post":{"tags":["account","notifications"],"summary":"AddEmail","description":"Enable email notification","operationId":"ControllersAccountNotificationsEmailAddAddEmail","requestBody":{"content":{"application/json":{"schema":{"type":"string","enum":["canary_renewals","canary_subscriptions","survey_submissions"]}}},"required":true},"responses":{"201":{"description":"Document created, URL follows","headers":{}},"400":{"description":"Bad request syntax or unsupported method","content":{"application/json":{"schema":{"properties":{"status_code":{"type":"integer"},"detail":{"type":"string"},"extra":{"additionalProperties":{},"type":["null","object","array"]}},"type":"object","required":["detail","status_code"],"description":"Validation Exception","examples":[{"status_code":400,"detail":"Bad Request","extra":{}}]}}}}},"deprecated":false}},"/controllers/account/notifications/email/remove":{"delete":{"tags":["account","notifications"],"summary":"RemoveEmail","description":"Disable email notification","operationId":"ControllersAccountNotificationsEmailRemoveRemoveEmail","requestBody":{"content":{"application/json":{"schema":{"type":"string","enum":["canary_renewals","canary_subscriptions","survey_submissions"]}}},"required":true},"responses":{"204":{"description":"Request fulfilled, nothing follows","headers":{}},"400":{"description":"Bad request syntax or unsupported method","content":{"application/json":{"schema":{"properties":{"status_code":{"type":"integer"},"detail":{"type":"string"},"extra":{"additionalProperties":{},"type":["null","object","array"]}},"type":"object","required":["detail","status_code"],"description":"Validation Exception","examples":[{"status_code":400,"detail":"Bad Request","extra":{}}]}}}}},"deprecated":false}},"/controllers/account/privacy/ip-progressing/disallow":{"delete":{"tags":["account","privacy"],"summary":"IpProgressing","operationId":"ControllersAccountPrivacyIpProgressingDisallowIpProgressing","responses":{"204":{"description":"Request fulfilled, nothing follows","headers":{}}},"deprecated":false}},"/controllers/account/privacy/ip-progressing/consent":{"post":{"tags":["account","privacy"],"summary":"IpProgressingConsent","operationId":"ControllersAccountPrivacyIpProgressingConsentIpProgressingConsent","responses":{"201":{"description":"Document created, URL follows","headers":{}}},"deprecated":false}},"/controllers/account/create":{"post":{"tags":["account"],"summary":"CreateAccount","description":"Create a user account","operationId":"ControllersAccountCreateCreateAccount","parameters":[{"name":"captcha","in":"query","schema":{"type":"string"},"required":true,"deprecated":false,"allowEmptyValue":false,"allowReserved":false}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateUserModel"}}},"required":true},"responses":{"201":{"description":"Document created, URL follows","headers":{},"content":{"application/json":{"schema":{}}}},"400":{"description":"Bad request syntax or unsupported method","content":{"application/json":{"schema":{"properties":{"status_code":{"type":"integer"},"detail":{"type":"string"},"extra":{"additionalProperties":{},"type":["null","object","array"]}},"type":"object","required":["detail","status_code"],"description":"Validation Exception","examples":[{"status_code":400,"detail":"Bad Request","extra":{}}]}}}}},"deprecated":false}},"/controllers/account/jwt":{"get":{"tags":["account"],"summary":"JwtInfo","description":"Get JWT sub for user","operationId":"ControllersAccountJwtJwtInfo","responses":{"200":{"description":"Request fulfilled, document follows","headers":{},"content":{"text/plain":{"schema":{"type":"string"}}}}},"deprecated":false}},"/controllers/account/email/resend":{"post":{"tags":["account"],"summary":"EmailResend","description":"Resends email verification","operationId":"ControllersAccountEmailResendEmailResend","responses":{"201":{"description":"Document created, URL follows","headers":{}}},"deprecated":false}},"/controllers/account/logout":{"delete":{"tags":["account"],"summary":"Logout","description":"Logout of User account","operationId":"ControllersAccountLogoutLogout","responses":{"200":{"description":"Request fulfilled, document follows","headers":{},"content":{"application/json":{"schema":{}}}}},"deprecated":false}},"/controllers/account/me":{"get":{"tags":["account"],"summary":"GetMe","description":"Get user info","operationId":"ControllersAccountMeGetMe","responses":{"200":{"description":"Request fulfilled, document follows","headers":{},"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserModel"}}}}},"deprecated":false}},"/controllers/account/password/reset":{"post":{"tags":["account"],"summary":"PasswordReset","description":"Reset password","operationId":"ControllersAccountPasswordResetPasswordReset","parameters":[{"name":"otp","in":"query","schema":{"oneOf":[{"type":"null"},{"type":"string"}]},"required":false,"deprecated":false,"allowEmptyValue":false,"allowReserved":false}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/AccountUpdatePassword"}}},"required":true},"responses":{"201":{"description":"Document created, URL follows","headers":{}},"400":{"description":"Bad request syntax or unsupported method","content":{"application/json":{"schema":{"properties":{"status_code":{"type":"integer"},"detail":{"type":"string"},"extra":{"additionalProperties":{},"type":["null","object","array"]}},"type":"object","required":["detail","status_code"],"description":"Validation Exception","examples":[{"status_code":400,"detail":"Bad Request","extra":{}}]}}}}},"deprecated":false}},"/controllers/session":{"get":{"tags":["session"],"summary":"GetSessions","description":"List active sessions","operationId":"ControllersSessionGetSessions","responses":{"200":{"description":"Request fulfilled, document follows","headers":{},"content":{"application/json":{"schema":{"items":{"$ref":"#/components/schemas/SessionModel"},"type":"array"}}}}},"deprecated":false}},"/controllers/session/{session_id}":{"delete":{"tags":["session"],"summary":"InvalidateSession","description":"Invalidate a session","operationId":"ControllersSessionSessionIdInvalidateSession","parameters":[{"name":"session_id","in":"path","schema":{"type":"string"},"required":true,"deprecated":false,"allowEmptyValue":false,"allowReserved":false}],"responses":{"204":{"description":"Request fulfilled, nothing follows","headers":{}},"400":{"description":"Bad request syntax or unsupported method","content":{"application/json":{"schema":{"properties":{"status_code":{"type":"integer"},"detail":{"type":"string"},"extra":{"additionalProperties":{},"type":["null","object","array"]}},"type":"object","required":["detail","status_code"],"description":"Validation Exception","examples":[{"status_code":400,"detail":"Bad Request","extra":{}}]}}}}},"deprecated":false}},"/controllers/canary/create":{"post":{"tags":["canary"],"summary":"CreateCanary","description":"Create a canary for a given domain","operationId":"ControllersCanaryCreateCreateCanary","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateCanaryModel"}}},"required":true},"responses":{"201":{"description":"Document created, URL follows","headers":{},"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CanaryModel"}}}},"400":{"description":"Bad request syntax or unsupported method","content":{"application/json":{"schema":{"properties":{"status_code":{"type":"integer"},"detail":{"type":"string"},"extra":{"additionalProperties":{},"type":["null","object","array"]}},"type":"object","required":["detail","status_code"],"description":"Validation Exception","examples":[{"status_code":400,"detail":"Bad Request","extra":{}}]}}}}},"deprecated":false}},"/controllers/canary/list":{"get":{"tags":["canary"],"summary":"ListCanaries","description":"List canaries for user","operationId":"ControllersCanaryListListCanaries","responses":{"200":{"description":"Request fulfilled, document follows","headers":{},"content":{"application/json":{"schema":{"items":{"$ref":"#/components/schemas/CanaryModel"},"type":"array"}}}}},"deprecated":false}},"/controllers/canary/trusted/list":{"get":{"tags":["canary"],"summary":"ListTrustedCanaries","description":"List trusted canaries","operationId":"ControllersCanaryTrustedListListTrustedCanaries","responses":{"200":{"description":"Request fulfilled, document follows","headers":{},"content":{"application/json":{"schema":{"type":"object"}}}}},"deprecated":false}},"/controllers/canary/published/{canary_id}/{page}":{"get":{"tags":["canary","warrant"],"summary":"PublishedWarrant","description":"Get a canary warrant","operationId":"ControllersCanaryPublishedCanaryIdPagePublishedWarrant","parameters":[{"name":"canary_id","in":"path","schema":{"type":"string"},"required":true,"deprecated":false,"allowEmptyValue":false,"allowReserved":false},{"name":"page","in":"path","schema":{"type":"integer"},"required":true,"deprecated":false,"allowEmptyValue":false,"allowReserved":false}],"responses":{"200":{"description":"Request fulfilled, document follows","headers":{},"content":{"application/json":{"schema":{"$ref":"#/components/schemas/PublishedCanaryWarrantModel"}}}},"400":{"description":"Bad request syntax or unsupported method","content":{"application/json":{"schema":{"properties":{"status_code":{"type":"integer"},"detail":{"type":"string"},"extra":{"additionalProperties":{},"type":["null","object","array"]}},"type":"object","required":["detail","status_code"],"description":"Validation Exception","examples":[{"status_code":400,"detail":"Bad Request","extra":{}}]}}}}},"deprecated":false}},"/controllers/canary/warrant/{warrant_id}/publish":{"post":{"tags":["canary","warrant"],"summary":"Publish","description":"Publish a canary","operationId":"ControllersCanaryWarrantWarrantIdPublishPublish","parameters":[{"name":"warrant_id","in":"path","schema":{"type":"string"},"required":true,"deprecated":false,"allowEmptyValue":false,"allowReserved":false}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/PublishCanaryWarrantModel"}}},"required":true},"responses":{"201":{"description":"Document created, URL follows","headers":{}},"400":{"description":"Bad request syntax or unsupported method","content":{"application/json":{"schema":{"properties":{"status_code":{"type":"integer"},"detail":{"type":"string"},"extra":{"additionalProperties":{},"type":["null","object","array"]}},"type":"object","required":["detail","status_code"],"description":"Validation Exception","examples":[{"status_code":400,"detail":"Bad Request","extra":{}}]}}}}},"deprecated":false}},"/controllers/canary/warrant/{warrant_id}/document/{hash_}":{"post":{"tags":["canary","document","warrant"],"summary":"UploadDocument","description":"Upload a canary warrant document","operationId":"ControllersCanaryWarrantWarrantIdDocumentHashUploadDocument","parameters":[{"name":"warrant_id","in":"path","schema":{"type":"string"},"required":true,"deprecated":false,"allowEmptyValue":false,"allowReserved":false},{"name":"hash_","in":"path","schema":{"type":"string"},"required":true,"deprecated":false,"allowEmptyValue":false,"allowReserved":false}],"requestBody":{"content":{"multipart/form-data":{"schema":{"items":{"type":"string","format":"binary","contentMediaType":"application/octet-stream"},"type":"array"}}},"required":true},"responses":{"201":{"description":"Document created, URL follows","headers":{}},"400":{"description":"Bad request syntax or unsupported method","content":{"application/json":{"schema":{"properties":{"status_code":{"type":"integer"},"detail":{"type":"string"},"extra":{"additionalProperties":{},"type":["null","object","array"]}},"type":"object","required":["detail","status_code"],"description":"Validation Exception","examples":[{"status_code":400,"detail":"Bad Request","extra":{}}]}}}}},"deprecated":false}},"/controllers/canary/{domain}/create/warrant":{"post":{"tags":["canary","warrant"],"summary":"CreateWarrant","description":"Create a warrant for a canary","operationId":"ControllersCanaryDomainCreateWarrantCreateWarrant","parameters":[{"name":"domain","in":"path","schema":{"type":"string"},"required":true,"deprecated":false,"allowEmptyValue":false,"allowReserved":false},{"name":"otp","in":"query","schema":{"type":"string"},"required":true,"deprecated":false,"allowEmptyValue":false,"allowReserved":false}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateCanaryWarrantModel"}}},"required":true},"responses":{"201":{"description":"Document created, URL follows","headers":{},"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreatedCanaryWarrantModel"}}}},"400":{"description":"Bad request syntax or unsupported method","content":{"application/json":{"schema":{"properties":{"status_code":{"type":"integer"},"detail":{"type":"string"},"extra":{"additionalProperties":{},"type":["null","object","array"]}},"type":"object","required":["detail","status_code"],"description":"Validation Exception","examples":[{"status_code":400,"detail":"Bad Request","extra":{}}]}}}}},"deprecated":false}},"/controllers/canary/{domain}/delete":{"delete":{"tags":["canary"],"summary":"DeleteCanary","description":"Delete a canary","operationId":"ControllersCanaryDomainDeleteDeleteCanary","parameters":[{"name":"domain","in":"path","schema":{"type":"string"},"required":true,"deprecated":false,"allowEmptyValue":false,"allowReserved":false},{"name":"otp","in":"query","schema":{"type":"string"},"required":true,"deprecated":false,"allowEmptyValue":false,"allowReserved":false}],"responses":{"204":{"description":"Request fulfilled, nothing follows","headers":{}},"400":{"description":"Bad request syntax or unsupported method","content":{"application/json":{"schema":{"properties":{"status_code":{"type":"integer"},"detail":{"type":"string"},"extra":{"additionalProperties":{},"type":["null","object","array"]}},"type":"object","required":["detail","status_code"],"description":"Validation Exception","examples":[{"status_code":400,"detail":"Bad Request","extra":{}}]}}}}},"deprecated":false}},"/controllers/canary/{domain}":{"get":{"tags":["canary"],"summary":"GetCanary","description":"Get private details about a canary","operationId":"ControllersCanaryDomainGetCanary","parameters":[{"name":"domain","in":"path","schema":{"type":"string"},"required":true,"deprecated":false,"allowEmptyValue":false,"allowReserved":false}],"responses":{"200":{"description":"Request fulfilled, document follows","headers":{},"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CanaryModel"}}}},"400":{"description":"Bad request syntax or unsupported method","content":{"application/json":{"schema":{"properties":{"status_code":{"type":"integer"},"detail":{"type":"string"},"extra":{"additionalProperties":{},"type":["null","object","array"]}},"type":"object","required":["detail","status_code"],"description":"Validation Exception","examples":[{"status_code":400,"detail":"Bad Request","extra":{}}]}}}}},"deprecated":false}},"/controllers/canary/{domain}/trusted":{"get":{"tags":["canary"],"summary":"GetTrusted","description":"Get signed public key hash for a trusted canary","operationId":"ControllersCanaryDomainTrustedGetTrusted","parameters":[{"name":"domain","in":"path","schema":{"type":"string"},"required":true,"deprecated":false,"allowEmptyValue":false,"allowReserved":false}],"responses":{"200":{"description":"Request fulfilled, document follows","headers":{},"content":{"application/json":{"schema":{"$ref":"#/components/schemas/TrustedCanaryModel"}}}},"400":{"description":"Bad request syntax or unsupported method","content":{"application/json":{"schema":{"properties":{"status_code":{"type":"integer"},"detail":{"type":"string"},"extra":{"additionalProperties":{},"type":["null","object","array"]}},"type":"object","required":["detail","status_code"],"description":"Validation Exception","examples":[{"status_code":400,"detail":"Bad Request","extra":{}}]}}}}},"deprecated":false}},"/controllers/canary/{domain}/public":{"get":{"tags":["canary"],"summary":"PublicCanary","description":"Get public details about canary","operationId":"ControllersCanaryDomainPublicPublicCanary","parameters":[{"name":"domain","in":"path","schema":{"type":"string"},"required":true,"deprecated":false,"allowEmptyValue":false,"allowReserved":false}],"responses":{"200":{"description":"Request fulfilled, document follows","headers":{},"content":{"application/json":{"schema":{"$ref":"#/components/schemas/PublicCanaryModel"}}}},"400":{"description":"Bad request syntax or unsupported method","content":{"application/json":{"schema":{"properties":{"status_code":{"type":"integer"},"detail":{"type":"string"},"extra":{"additionalProperties":{},"type":["null","object","array"]}},"type":"object","required":["detail","status_code"],"description":"Validation Exception","examples":[{"status_code":400,"detail":"Bad Request","extra":{}}]}}}}},"deprecated":false}},"/controllers/canary/{domain}/trusted/add":{"post":{"tags":["canary"],"summary":"TrustCanary","description":"Saves a canary as a trusted canary","operationId":"ControllersCanaryDomainTrustedAddTrustCanary","parameters":[{"name":"domain","in":"path","schema":{"type":"string"},"required":true,"deprecated":false,"allowEmptyValue":false,"allowReserved":false}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/TrustedCanaryModel"}}},"required":true},"responses":{"201":{"description":"Document created, URL follows","headers":{}},"400":{"description":"Bad request syntax or unsupported method","content":{"application/json":{"schema":{"properties":{"status_code":{"type":"integer"},"detail":{"type":"string"},"extra":{"additionalProperties":{},"type":["null","object","array"]}},"type":"object","required":["detail","status_code"],"description":"Validation Exception","examples":[{"status_code":400,"detail":"Bad Request","extra":{}}]}}}}},"deprecated":false}},"/controllers/canary/{domain}/logo/update":{"post":{"tags":["canary"],"summary":"UpdateLogo","description":"Update logo for given domain","operationId":"ControllersCanaryDomainLogoUpdateUpdateLogo","parameters":[{"name":"domain","in":"path","schema":{"type":"string"},"required":true,"deprecated":false,"allowEmptyValue":false,"allowReserved":false}],"requestBody":{"content":{"multipart/form-data":{"schema":{"items":{"type":"string","format":"binary","contentMediaType":"application/octet-stream"},"type":"array"}}},"required":true},"responses":{"201":{"description":"Document created, URL follows","headers":{}},"400":{"description":"Bad request syntax or unsupported method","content":{"application/json":{"schema":{"properties":{"status_code":{"type":"integer"},"detail":{"type":"string"},"extra":{"additionalProperties":{},"type":["null","object","array"]}},"type":"object","required":["detail","status_code"],"description":"Validation Exception","examples":[{"status_code":400,"detail":"Bad Request","extra":{}}]}}}}},"deprecated":false}},"/controllers/canary/{domain}/verify":{"post":{"tags":["canary"],"summary":"Verify","description":"Verify domain ownership via DNS","operationId":"ControllersCanaryDomainVerifyVerify","parameters":[{"name":"domain","in":"path","schema":{"type":"string"},"required":true,"deprecated":false,"allowEmptyValue":false,"allowReserved":false}],"responses":{"201":{"description":"Document created, URL follows","headers":{},"content":{"application/json":{"schema":{}}}},"400":{"description":"Bad request syntax or unsupported method","content":{"application/json":{"schema":{"properties":{"status_code":{"type":"integer"},"detail":{"type":"string"},"extra":{"additionalProperties":{},"type":["null","object","array"]}},"type":"object","required":["detail","status_code"],"description":"Validation Exception","examples":[{"status_code":400,"detail":"Bad Request","extra":{}}]}}}}},"deprecated":false}},"/controllers/canary/subscription/{canary_id}":{"get":{"tags":["canary","subscription"],"summary":"AmSubscribed","description":"Check if user is subscribed to a canary","operationId":"ControllersCanarySubscriptionCanaryIdAmSubscribed","parameters":[{"name":"canary_id","in":"path","schema":{"type":"string"},"required":true,"deprecated":false,"allowEmptyValue":false,"allowReserved":false}],"responses":{"200":{"description":"Request fulfilled, document follows","headers":{},"content":{"application/json":{"schema":{"type":"boolean"}}}},"400":{"description":"Bad request syntax or unsupported method","content":{"application/json":{"schema":{"properties":{"status_code":{"type":"integer"},"detail":{"type":"string"},"extra":{"additionalProperties":{},"type":["null","object","array"]}},"type":"object","required":["detail","status_code"],"description":"Validation Exception","examples":[{"status_code":400,"detail":"Bad Request","extra":{}}]}}}}},"deprecated":false}},"/controllers/canary/subscription/{canary_id}/subscribe":{"post":{"tags":["canary","subscription"],"summary":"Subscribe","description":"Subscribe to a canary","operationId":"ControllersCanarySubscriptionCanaryIdSubscribeSubscribe","parameters":[{"name":"canary_id","in":"path","schema":{"type":"string"},"required":true,"deprecated":false,"allowEmptyValue":false,"allowReserved":false}],"responses":{"201":{"description":"Document created, URL follows","headers":{}},"400":{"description":"Bad request syntax or unsupported method","content":{"application/json":{"schema":{"properties":{"status_code":{"type":"integer"},"detail":{"type":"string"},"extra":{"additionalProperties":{},"type":["null","object","array"]}},"type":"object","required":["detail","status_code"],"description":"Validation Exception","examples":[{"status_code":400,"detail":"Bad Request","extra":{}}]}}}}},"deprecated":false}},"/controllers/canary/subscription/{canary_id}/unsubscribe":{"delete":{"tags":["canary","subscription"],"summary":"Unsubscribe","description":"Unsubscribe from a canary","operationId":"ControllersCanarySubscriptionCanaryIdUnsubscribeUnsubscribe","parameters":[{"name":"canary_id","in":"path","schema":{"type":"string"},"required":true,"deprecated":false,"allowEmptyValue":false,"allowReserved":false}],"responses":{"204":{"description":"Request fulfilled, nothing follows","headers":{}},"400":{"description":"Bad request syntax or unsupported method","content":{"application/json":{"schema":{"properties":{"status_code":{"type":"integer"},"detail":{"type":"string"},"extra":{"additionalProperties":{},"type":["null","object","array"]}},"type":"object","required":["detail","status_code"],"description":"Validation Exception","examples":[{"status_code":400,"detail":"Bad Request","extra":{}}]}}}}},"deprecated":false}},"/controllers/survey/{survey_id}/public":{"get":{"tags":["survey"],"summary":"PublicSurvey","description":"Get a survey","operationId":"ControllersSurveySurveyIdPublicPublicSurvey","parameters":[{"name":"survey_id","in":"path","schema":{"type":"string"},"required":true,"deprecated":false,"allowEmptyValue":false,"allowReserved":false}],"responses":{"200":{"description":"Request fulfilled, document follows","headers":{},"content":{"application/json":{"schema":{"$ref":"#/components/schemas/SurveyPublicModel"}}}},"400":{"description":"Bad request syntax or unsupported method","content":{"application/json":{"schema":{"properties":{"status_code":{"type":"integer"},"detail":{"type":"string"},"extra":{"additionalProperties":{},"type":["null","object","array"]}},"type":"object","required":["detail","status_code"],"description":"Validation Exception","examples":[{"status_code":400,"detail":"Bad Request","extra":{}}]}}}}},"deprecated":false}},"/controllers/survey/create":{"post":{"tags":["survey"],"summary":"CreateSurvey","description":"Create a survey","operationId":"ControllersSurveyCreateCreateSurvey","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/SurveyCreateModel"}}},"required":true},"responses":{"201":{"description":"Document created, URL follows","headers":{},"content":{"application/json":{"schema":{"$ref":"#/components/schemas/SurveyModel"}}}},"400":{"description":"Bad request syntax or unsupported method","content":{"application/json":{"schema":{"properties":{"status_code":{"type":"integer"},"detail":{"type":"string"},"extra":{"additionalProperties":{},"type":["null","object","array"]}},"type":"object","required":["detail","status_code"],"description":"Validation Exception","examples":[{"status_code":400,"detail":"Bad Request","extra":{}}]}}}}},"deprecated":false}}},"components":{"schemas":{"UserLoginSignatureModel":{"properties":{"signature":{"type":"string"},"one_day_login":{"type":"boolean"},"_id":{"type":"string"}},"type":"object","required":["_id","signature"],"title":"UserLoginSignatureModel"},"AccountAuthModal":{"properties":{"public_key":{"type":"string"}},"type":"object","required":["public_key"],"title":"AccountAuthModal"},"AccountX25519Model":{"properties":{"iv":{"type":"string"},"public_key":{"type":"string"},"cipher_text":{"type":"string"}},"type":"object","required":["cipher_text","iv","public_key"],"title":"AccountX25519Model"},"AccountEd25199Modal":{"properties":{"iv":{"type":"string"},"public_key":{"type":"string"},"cipher_text":{"type":"string"}},"type":"object","required":["cipher_text","iv","public_key"],"title":"AccountEd25199Modal"},"AccountKeychainModal":{"properties":{"iv":{"type":"string"},"cipher_text":{"type":"string"}},"type":"object","required":["cipher_text","iv"],"title":"AccountKeychainModal"},"Argon2Modal":{"properties":{"salt":{"type":"string"},"time_cost":{"type":"integer"},"memory_cost":{"type":"integer"}},"type":"object","required":["salt"],"title":"Argon2Modal"},"OtpModel":{"properties":{"secret":{"oneOf":[{"type":"null"},{"type":"string"}]},"provisioning_uri":{"oneOf":[{"type":"null"},{"type":"string"}]},"completed":{"type":"boolean"}},"type":"object","required":[],"title":"OtpModel"},"NotificationsModel":{"properties":{"email":{"items":{"type":"string","enum":["canary_renewals","canary_subscriptions","survey_submissions"]},"type":"array"},"webhooks":{"type":"object"}},"type":"object","required":["email","webhooks"],"title":"NotificationsModel"},"UserModel":{"properties":{"email":{"type":"string","format":"email"},"auth":{"$ref":"#/components/schemas/AccountAuthModal"},"keypair":{"$ref":"#/components/schemas/AccountX25519Model"},"sign_keypair":{"$ref":"#/components/schemas/AccountEd25199Modal"},"keychain":{"$ref":"#/components/schemas/AccountKeychainModal"},"kdf":{"$ref":"#/components/schemas/Argon2Modal"},"signature":{"type":"string"},"ip_lookup_consent":{"type":"boolean"},"algorithms":{"type":"string"},"_id":{},"created":{"type":"string","format":"date-time"},"otp":{"$ref":"#/components/schemas/OtpModel"},"email_verified":{"type":"boolean"},"notifications":{"$ref":"#/components/schemas/NotificationsModel"}},"type":"object","required":["_id","auth","created","email","kdf","keychain","keypair","notifications","otp","sign_keypair","signature"],"title":"UserModel"},"UserJtiModel":{"properties":{"jti":{},"user":{"$ref":"#/components/schemas/UserModel"}},"type":"object","required":["jti","user"],"title":"UserJtiModel"},"PublicUserModel":{"properties":{"kdf":{"$ref":"#/components/schemas/Argon2Modal"},"otp_completed":{"type":"boolean"}},"type":"object","required":["kdf"],"title":"PublicUserModel"},"UserToSignModel":{"properties":{"to_sign":{"type":"string"},"_id":{}},"type":"object","required":["_id","to_sign"],"title":"UserToSignModel"},"WebhookModel":{"properties":{"url":{"type":"string","maxLength":2083,"format":"url","description":"must be a valid HTTP based URL"},"type":{"type":"string","enum":["canary_renewals","canary_subscriptions","survey_submissions"]}},"type":"object","required":["type","url"],"title":"WebhookModel"},"CreateUserModel":{"properties":{"auth":{"$ref":"#/components/schemas/AccountAuthModal"},"keypair":{"$ref":"#/components/schemas/AccountX25519Model"},"sign_keypair":{"$ref":"#/components/schemas/AccountEd25199Modal"},"keychain":{"$ref":"#/components/schemas/AccountKeychainModal"},"kdf":{"$ref":"#/components/schemas/Argon2Modal"},"signature":{"type":"string"},"email":{"type":"string","format":"email"},"ip_lookup_consent":{"type":"boolean"},"algorithms":{"type":"string"}},"type":"object","required":["auth","email","kdf","keychain","keypair","sign_keypair","signature"],"title":"CreateUserModel"},"AccountUpdatePassword":{"properties":{"auth":{"$ref":"#/components/schemas/AccountAuthModal"},"keypair":{"$ref":"#/components/schemas/AccountX25519Model"},"sign_keypair":{"$ref":"#/components/schemas/AccountEd25199Modal"},"keychain":{"$ref":"#/components/schemas/AccountKeychainModal"},"kdf":{"$ref":"#/components/schemas/Argon2Modal"},"signature":{"type":"string"}},"type":"object","required":["auth","kdf","keychain","keypair","sign_keypair","signature"],"title":"AccountUpdatePassword"},"SessionLocationModel":{"properties":{"region":{"oneOf":[{"type":"null"},{"type":"string"}]},"country":{"oneOf":[{"type":"null"},{"type":"string"}]},"ip":{"oneOf":[{"type":"null"},{"type":"string"}]}},"type":"object","required":[],"title":"SessionLocationModel"},"SessionModel":{"properties":{"expires":{"type":"string","format":"date-time"},"record_kept_till":{"type":"string","format":"date-time"},"created":{"type":"string","format":"date-time"},"location":{"$ref":"#/components/schemas/SessionLocationModel"},"device":{"oneOf":[{"type":"null"},{"type":"string"}]},"user_id":{},"_id":{}},"type":"object","required":["_id","created","expires","location","record_kept_till","user_id"],"title":"SessionModel"},"CanaryEd25519Model":{"properties":{"public_key":{"type":"string"},"iv":{"type":"string"},"cipher_text":{"type":"string"}},"type":"object","required":["cipher_text","iv","public_key"],"title":"CanaryEd25519Model"},"CreateCanaryModel":{"properties":{"domain":{"type":"string"},"about":{"type":"string"},"signature":{"type":"string"},"algorithms":{"type":"string"},"keypair":{"$ref":"#/components/schemas/CanaryEd25519Model"}},"type":"object","required":["about","domain","keypair","signature"],"title":"CreateCanaryModel"},"DomainVerification":{"properties":{"completed":{"type":"boolean"},"code":{"type":"string"},"code_prefixed":{"type":"string"}},"type":"object","required":["code"],"title":"DomainVerification"},"CanaryModel":{"properties":{"domain":{"type":"string"},"about":{"type":"string"},"signature":{"type":"string"},"algorithms":{"type":"string"},"_id":{},"logo":{"oneOf":[{"type":"null"},{"type":"string"}]},"user_id":{},"created":{"type":"string","format":"date-time"},"keypair":{"$ref":"#/components/schemas/CanaryEd25519Model"},"domain_verification":{"$ref":"#/components/schemas/DomainVerification"}},"type":"object","required":["_id","about","created","domain","domain_verification","keypair","signature","user_id"],"title":"CanaryModel"},"DocumentCanaryWarrantModel":{"properties":{"hash":{"type":"string"},"filename":{"type":"string"},"download_url":{"type":"string"},"file_id":{"type":"string"},"size":{"type":"integer"}},"type":"object","required":["file_id","filename","hash","size"],"title":"DocumentCanaryWarrantModel"},"PublishedCanaryWarrantModel":{"properties":{"_id":{},"next_canary":{"type":"string","format":"date-time"},"issued":{"type":"string","format":"date-time"},"signature":{"type":"string"},"btc_latest_block":{"type":"string"},"statement":{"type":"string"},"concern":{"type":"string","enum":["none","mild","moderate","severe"]},"canary_id":{},"user_id":{},"active":{"type":"boolean"},"documents":{"items":{"$ref":"#/components/schemas/DocumentCanaryWarrantModel"},"type":"array"}},"type":"object","required":["_id","active","btc_latest_block","canary_id","concern","documents","issued","next_canary","signature","user_id"],"title":"PublishedCanaryWarrantModel"},"PublishCanaryWarrantModel":{"properties":{"signature":{"type":"string"},"btc_latest_block":{"type":"string"},"statement":{"type":"string"},"concern":{"type":"string","enum":["none","mild","moderate","severe"]}},"type":"object","required":["btc_latest_block","concern","signature"],"title":"PublishCanaryWarrantModel"},"CreateCanaryWarrantModel":{"properties":{"next":{"type":"string","enum":["tomorrow","week","fortnight","month","quarter","year"]}},"type":"object","required":["next"],"title":"CreateCanaryWarrantModel"},"CreatedCanaryWarrantModel":{"properties":{"_id":{},"next_canary":{"type":"string","format":"date-time"},"issued":{"type":"string","format":"date-time"}},"type":"object","required":["_id","issued","next_canary"],"title":"CreatedCanaryWarrantModel"},"TrustedCanaryModel":{"properties":{"public_key_hash":{"type":"string"},"signature":{"type":"string"}},"type":"object","required":["public_key_hash","signature"],"title":"TrustedCanaryModel"},"PublicKeyModel":{"properties":{"public_key":{"type":"string"}},"type":"object","required":["public_key"],"title":"PublicKeyModel"},"PublicCanaryModel":{"properties":{"domain":{"type":"string"},"about":{"type":"string"},"signature":{"type":"string"},"algorithms":{"type":"string"},"_id":{},"logo":{"oneOf":[{"type":"null"},{"type":"string"}]},"user_id":{},"created":{"type":"string","format":"date-time"},"keypair":{"$ref":"#/components/schemas/PublicKeyModel"}},"type":"object","required":["_id","about","created","domain","keypair","signature","user_id"],"title":"PublicCanaryModel"},"TitleModel":{"properties":{"iv":{"type":"string"},"cipher_text":{"type":"string"}},"type":"object","required":["cipher_text","iv"],"title":"TitleModel"},"SurveyDescriptionModel":{"properties":{"iv":{"type":"string"},"cipher_text":{"type":"string"}},"type":"object","required":["cipher_text","iv"],"title":"SurveyDescriptionModel"},"SurveyRegexModel":{"properties":{"iv":{"type":"string"},"cipher_text":{"type":"string"}},"type":"object","required":["cipher_text","iv"],"title":"SurveyRegexModel"},"SurveyQuestionsModel":{"properties":{"iv":{"type":"string"},"cipher_text":{"type":"string"}},"type":"object","required":["cipher_text","iv"],"title":"SurveyQuestionsModel"},"SurveyChoicesModel":{"properties":{"iv":{"type":"string"},"id":{"type":"integer"},"cipher_text":{"type":"string"}},"type":"object","required":["cipher_text","id","iv"],"title":"SurveyChoicesModel"},"SurveyQuestionModel":{"properties":{"id":{"type":"integer"},"regex":{"oneOf":[{"type":"null"},{"$ref":"#/components/schemas/SurveyRegexModel"}]},"description":{"oneOf":[{"type":"null"},{"$ref":"#/components/schemas/SurveyDescriptionModel"}]},"question":{"$ref":"#/components/schemas/SurveyQuestionsModel"},"choices":{"oneOf":[{"type":"null"},{"items":{"$ref":"#/components/schemas/SurveyChoicesModel"},"type":"array"}]},"required":{"type":"boolean"},"type":{"oneOf":[{"type":"string","const":"Short Answer"},{"type":"string","const":"Paragraph"},{"type":"string","const":"Multiple Choice"},{"type":"string","const":"Single Choice"}]}},"type":"object","required":["id","question","type"],"title":"SurveyQuestionModel"},"SurveySignPublicKeyModel":{"properties":{"public_key":{"type":"string"}},"type":"object","required":["public_key"],"title":"SurveySignPublicKeyModel"},"SurveyKeypairCipherModel":{"properties":{"iv":{"type":"string"},"cipher_text":{"type":"string"}},"type":"object","required":["cipher_text","iv"],"title":"SurveyKeypairCipherModel"},"SurveyPublicKeyModel":{"properties":{"public_key":{"$ref":"#/components/schemas/SurveyKeypairCipherModel"}},"type":"object","required":["public_key"],"title":"SurveyPublicKeyModel"},"SurveyPublicModel":{"properties":{"title":{"$ref":"#/components/schemas/TitleModel"},"description":{"oneOf":[{"type":"null"},{"$ref":"#/components/schemas/SurveyDescriptionModel"}]},"questions":{"items":{"$ref":"#/components/schemas/SurveyQuestionModel"},"type":"array"},"signature":{"type":"string"},"requires_login":{"type":"boolean"},"proxy_block":{"type":"boolean"},"allow_multiple_submissions":{"type":"boolean"},"algorithms":{"type":"string"},"created":{"type":"string","format":"date-time"},"_id":{},"user_id":{},"sign_keypair":{"$ref":"#/components/schemas/SurveySignPublicKeyModel"},"keypair":{"$ref":"#/components/schemas/SurveyPublicKeyModel"}},"type":"object","required":["_id","created","keypair","questions","sign_keypair","signature","title","user_id"],"title":"SurveyPublicModel"},"SurveySignKeyPairModel":{"properties":{"iv":{"type":"string"},"public_key":{"type":"string"},"cipher_text":{"type":"string"}},"type":"object","required":["cipher_text","iv","public_key"],"title":"SurveySignKeyPairModel"},"SurveySecretKeyModel":{"properties":{"iv":{"type":"string"},"cipher_text":{"type":"string"}},"type":"object","required":["cipher_text","iv"],"title":"SurveySecretKeyModel"},"SurveyKeypairModel":{"properties":{"public_key":{"$ref":"#/components/schemas/SurveyKeypairCipherModel"},"private_key":{"$ref":"#/components/schemas/SurveyKeypairCipherModel"}},"type":"object","required":["private_key","public_key"],"title":"SurveyKeypairModel"},"SurveyCreateModel":{"properties":{"title":{"$ref":"#/components/schemas/TitleModel"},"description":{"oneOf":[{"type":"null"},{"$ref":"#/components/schemas/SurveyDescriptionModel"}]},"questions":{"items":{"$ref":"#/components/schemas/SurveyQuestionModel"},"type":"array"},"signature":{"type":"string"},"requires_login":{"type":"boolean"},"proxy_block":{"type":"boolean"},"allow_multiple_submissions":{"type":"boolean"},"algorithms":{"type":"string"},"sign_keypair":{"$ref":"#/components/schemas/SurveySignKeyPairModel"},"secret_key":{"$ref":"#/components/schemas/SurveySecretKeyModel"},"keypair":{"$ref":"#/components/schemas/SurveyKeypairModel"}},"type":"object","required":["keypair","questions","secret_key","sign_keypair","signature","title"],"title":"SurveyCreateModel"},"SurveyModel":{"properties":{"title":{"$ref":"#/components/schemas/TitleModel"},"description":{"oneOf":[{"type":"null"},{"$ref":"#/components/schemas/SurveyDescriptionModel"}]},"questions":{"items":{"$ref":"#/components/schemas/SurveyQuestionModel"},"type":"array"},"signature":{"type":"string"},"requires_login":{"type":"boolean"},"proxy_block":{"type":"boolean"},"allow_multiple_submissions":{"type":"boolean"},"algorithms":{"type":"string"},"sign_keypair":{"$ref":"#/components/schemas/SurveySignPublicKeyModel"},"secret_key":{"$ref":"#/components/schemas/SurveySecretKeyModel"},"keypair":{"$ref":"#/components/schemas/SurveyPublicKeyModel"},"created":{"type":"string","format":"date-time"},"_id":{},"user_id":{}},"type":"object","required":["_id","created","keypair","questions","secret_key","sign_keypair","signature","title","user_id"],"title":"SurveyModel"}},"securitySchemes":{"BearerToken":{"type":"http","description":"JWT cookie-based authentication and authorization.","name":"token","in":"cookie","scheme":"Bearer","bearerFormat":"JWT"}}},"security":[{"BearerToken":[]}]}